---
jobs:
- name: build
  public: true
  plan:
  - get: bosh-lite-spiff-dockerhub
    trigger: true
    params:
      save: true
  - get: cf-release
    trigger: true
  - get: cf-release-git
    trigger: true
  - get: bosh-lite-stemcell
    trigger: true
  - get: cf-release-dockerfile
    trigger: true
  - task: do-the-thing
    file: cf-release-dockerfile/ci/task.yml
    privileged: true
  - put: cf-release-dockerhub
    params:
      build: bosh-lite-spiff-dockerfile

resources:
- name: cf-release-git
  type: git-fork
  source:
    uri: https://github.com/cloudfoundry/cf-release.git

- name: cf-release
  type: bosh-io-release
  source:
    repository: cloudfoundry/cf-release

- name: bosh-lite-stemcell
  type: bosh-io-stemcell
  source:
    name: bosh-warden-boshlite-ubuntu-trusty-go_agent

- name: cf-release-dockerfile
  type: git-fork
  source:
    uri: https://github.com/EngineerBetter/cf-release-dockerfile.git

- name: bosh-lite-spiff-dockerhub
  type: docker-image
  source:
    repository: engineerbetter/bosh-lite-spiff
    username: {{docker-user}}
    password: {{docker-password}}

- name: cf-release-dockerhub
  type: docker-image
  source:
    repository: engineerbetter/cf-release
    username: {{docker-user}}
    password: {{docker-password}}

resource_types:
- name: git-fork
  type: docker-image
  source:
    repository: engineerbetter/git-resource
    params:
      submodule_jobs: 343